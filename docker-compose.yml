version: '3'

volumes:
  database: {}

services:
  database:
    image: postgres:11.6
    environment:
      POSTGRES_USER: docker
      POSTGRES_PASSWORD: docker
      POSTGRES_DB: permacoop
      PGUSER: docker
      PGPASSWORD: docker
    volumes:
      - 'database:/var/lib/postgresql/data'
    ports:
      - 5432:5432

  nginx:
    image: nginx:latest
    extra_hosts:
      # Make localhost on the host machine available to Nginx inside the container.
      # See: https://www.howtogeek.com/devops/how-to-connect-to-localhost-within-a-docker-container/
      - host.docker.internal:host-gateway
    ports:
      - 3001:3001
    volumes:
      - ./client/proxy/nginx.conf:/etc/nginx/conf.d/default.conf:ro
